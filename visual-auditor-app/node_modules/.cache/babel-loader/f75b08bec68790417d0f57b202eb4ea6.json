{"ast":null,"code":"import { Adder } from \"d3-array\";\nimport { atan2, cos, quarterPi, radians, sin, tau } from \"./math.js\";\nimport noop from \"./noop.js\";\nimport stream from \"./stream.js\";\nexport var areaRingSum = new Adder(); // hello?\n\nvar areaSum = new Adder(),\n    lambda00,\n    phi00,\n    lambda0,\n    cosPhi0,\n    sinPhi0;\nexport var areaStream = {\n  point: noop,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: function polygonStart() {\n    areaRingSum = new Adder();\n    areaStream.lineStart = areaRingStart;\n    areaStream.lineEnd = areaRingEnd;\n  },\n  polygonEnd: function polygonEnd() {\n    var areaRing = +areaRingSum;\n    areaSum.add(areaRing < 0 ? tau + areaRing : areaRing);\n    this.lineStart = this.lineEnd = this.point = noop;\n  },\n  sphere: function sphere() {\n    areaSum.add(tau);\n  }\n};\n\nfunction areaRingStart() {\n  areaStream.point = areaPointFirst;\n}\n\nfunction areaRingEnd() {\n  areaPoint(lambda00, phi00);\n}\n\nfunction areaPointFirst(lambda, phi) {\n  areaStream.point = areaPoint;\n  lambda00 = lambda, phi00 = phi;\n  lambda *= radians, phi *= radians;\n  lambda0 = lambda, cosPhi0 = cos(phi = phi / 2 + quarterPi), sinPhi0 = sin(phi);\n}\n\nfunction areaPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  phi = phi / 2 + quarterPi; // half the angular distance from south pole\n  // Spherical excess E for a spherical triangle with vertices: south pole,\n  // previous point, current point.  Uses a formula derived from Cagnoli’s\n  // theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).\n\n  var dLambda = lambda - lambda0,\n      sdLambda = dLambda >= 0 ? 1 : -1,\n      adLambda = sdLambda * dLambda,\n      cosPhi = cos(phi),\n      sinPhi = sin(phi),\n      k = sinPhi0 * sinPhi,\n      u = cosPhi0 * cosPhi + k * cos(adLambda),\n      v = k * sdLambda * sin(adLambda);\n  areaRingSum.add(atan2(v, u)); // Advance the previous points.\n\n  lambda0 = lambda, cosPhi0 = cosPhi, sinPhi0 = sinPhi;\n}\n\nexport default function (object) {\n  areaSum = new Adder();\n  stream(object, areaStream);\n  return areaSum * 2;\n}","map":{"version":3,"sources":["/Users/davidmunechika/Documents/Code/Research/visual-auditor/visual-auditor-app/node_modules/d3-geo/src/area.js"],"names":["Adder","atan2","cos","quarterPi","radians","sin","tau","noop","stream","areaRingSum","areaSum","lambda00","phi00","lambda0","cosPhi0","sinPhi0","areaStream","point","lineStart","lineEnd","polygonStart","areaRingStart","areaRingEnd","polygonEnd","areaRing","add","sphere","areaPointFirst","areaPoint","lambda","phi","dLambda","sdLambda","adLambda","cosPhi","sinPhi","k","u","v","object"],"mappings":"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","sourcesContent":["import {Adder} from \"d3-array\";\nimport {atan2, cos, quarterPi, radians, sin, tau} from \"./math.js\";\nimport noop from \"./noop.js\";\nimport stream from \"./stream.js\";\n\nexport var areaRingSum = new Adder();\n\n// hello?\n\nvar areaSum = new Adder(),\n    lambda00,\n    phi00,\n    lambda0,\n    cosPhi0,\n    sinPhi0;\n\nexport var areaStream = {\n  point: noop,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: function() {\n    areaRingSum = new Adder();\n    areaStream.lineStart = areaRingStart;\n    areaStream.lineEnd = areaRingEnd;\n  },\n  polygonEnd: function() {\n    var areaRing = +areaRingSum;\n    areaSum.add(areaRing < 0 ? tau + areaRing : areaRing);\n    this.lineStart = this.lineEnd = this.point = noop;\n  },\n  sphere: function() {\n    areaSum.add(tau);\n  }\n};\n\nfunction areaRingStart() {\n  areaStream.point = areaPointFirst;\n}\n\nfunction areaRingEnd() {\n  areaPoint(lambda00, phi00);\n}\n\nfunction areaPointFirst(lambda, phi) {\n  areaStream.point = areaPoint;\n  lambda00 = lambda, phi00 = phi;\n  lambda *= radians, phi *= radians;\n  lambda0 = lambda, cosPhi0 = cos(phi = phi / 2 + quarterPi), sinPhi0 = sin(phi);\n}\n\nfunction areaPoint(lambda, phi) {\n  lambda *= radians, phi *= radians;\n  phi = phi / 2 + quarterPi; // half the angular distance from south pole\n\n  // Spherical excess E for a spherical triangle with vertices: south pole,\n  // previous point, current point.  Uses a formula derived from Cagnoli’s\n  // theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).\n  var dLambda = lambda - lambda0,\n      sdLambda = dLambda >= 0 ? 1 : -1,\n      adLambda = sdLambda * dLambda,\n      cosPhi = cos(phi),\n      sinPhi = sin(phi),\n      k = sinPhi0 * sinPhi,\n      u = cosPhi0 * cosPhi + k * cos(adLambda),\n      v = k * sdLambda * sin(adLambda);\n  areaRingSum.add(atan2(v, u));\n\n  // Advance the previous points.\n  lambda0 = lambda, cosPhi0 = cosPhi, sinPhi0 = sinPhi;\n}\n\nexport default function(object) {\n  areaSum = new Adder();\n  stream(object, areaStream);\n  return areaSum * 2;\n}\n"]},"metadata":{},"sourceType":"module"}